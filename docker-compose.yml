services:
  pdf-service:
    image: seu-user/pdf-service:latest
    environment:
      - NODE_ENV=production
      - PORT=3001
      - PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium-browser
      - PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
    networks:
      - externa
      - interna
    deploy:
      mode: replicated
      replicas: 1
      placement:
        constraints:
          - node.role == manager
      resources:
        limits:
          cpus: "1.0"
          memory: 1G
        reservations:
          cpus: "0.25"
          memory: 256M
      # labels:
      #   - 'traefik.enable=true'
      #   - 'traefik.http.services.pdf-service.loadbalancer.server.port=3001'
      #   - 'traefik.http.services.pdf-service.loadbalancer.passHostHeader=true'
      #   - 'traefik.http.routers.pdf-service.service=pdf-service'
      #   - 'traefik.http.routers.pdf-service.rule=Host(`pdf.juriai.com.br`)'
      #   - 'traefik.http.routers.pdf-service.tls.certresolver=le'
      #   - 'traefik.http.routers.pdf-service.entrypoints=websecure'
      #   - 'traefik.http.routers.pdf-service.tls=true'

networks:
  externa:
    external: true
  interna:
    external: true
